import torch
import torch.nn as nn

class ExploitsModel(nn.Module):   
    def __init__(self, encoder,config,tokenizer,args):
        super(ExploitsModel, self).__init__()
        self.encoder = encoder
        self.config=config
        self.tokenizer=tokenizer
        self.args=args
    
        
    def forward(self, input_ids=None,labels=None): 
        logits=self.encoder(input_ids,attention_mask=input_ids.ne(1))[0]
        prob=torch.softmax(logits,-1)
        loss_fct = nn.CrossEntropyLoss(ignore_index=-1)
        loss = loss_fct(logits,labels)
        return loss,prob